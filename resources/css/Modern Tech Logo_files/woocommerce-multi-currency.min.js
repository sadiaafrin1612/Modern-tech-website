jQuery(document).ready(function(e){"use strict";e(document.body).on("updated_checkout",function(c,r){r.hasOwnProperty("wmc_update_checkout")&&r.wmc_update_checkout&&e(document.body).trigger("update_checkout")}),e(document.body).on("payment_method_selected",function(c,r){"ppcp-gateway"===e('.woocommerce-checkout input[name="payment_method"]:checked').val()&&e(document.body).trigger("update_checkout")}),window.woocommerce_multi_currency={init:function(){this.design(),this.checkPosition(),"1"===wooMultiCurrencyParams.enableCacheCompatible&&(this.cacheCompatible(),this.ajaxComplete())},disableCurrentCurrencyLink(){e(".wmc-active a").on("click",function(e){e.preventDefault(),e.stopImmediatePropagation()})},design:function(){jQuery(window).width()<=768?jQuery(".woocommerce-multi-currency.wmc-sidebar").on("click",function(){jQuery(this).toggleClass("wmc-hover"),jQuery(this).hasClass("wmc-hover")?jQuery("html").css({overflow:"hidden"}):jQuery("html").css({overflow:"visible"})}):(jQuery(".woocommerce-multi-currency.wmc-sidebar").on("mouseenter",function(){jQuery(this).addClass("wmc-hover")}),jQuery(".woocommerce-multi-currency.wmc-sidebar").on("mouseleave",function(){jQuery(this).removeClass("wmc-hover")}))},checkPosition:function(){jQuery(".woocommerce-multi-currency .wmc-currency-wrapper").on("mouseenter",function(){this.getBoundingClientRect().top/e(window).height()>.5?e(".woocommerce-multi-currency .wmc-sub-currency").addClass("wmc-show-up"):e(".woocommerce-multi-currency .wmc-sub-currency").removeClass("wmc-show-up")})},cacheCompatible(){if("undefined"!=typeof wc_checkout_params&&1===parseInt(wc_checkout_params.is_checkout))return;let c=[],r=e(".wmc-cache-pid");r.length&&r.each(function(r,t){let a=e(t).data("wmc_product_id");a&&c.push(a)});let t=e(".variations_form");t.length&&t.each(function(r,t){let a=e(t).data("product_variations");a.length&&a.forEach(e=>{c.push(e.variation_id)})});let a=e(".woocommerce-multi-currency.wmc-shortcode").not(".wmc-list-currency-rates"),o=[];a.map(function(){let c=e(this);o.push({layout:c.data("layout"),flag_size:c.data("flag_size")})}),c.length&&(c=[...new Set(c)]);let i=[];e(".wmc-cache-value").each(function(c,r){i.push({price:e(r).data("price"),original_price:e(r).data("original_price"),currency:e(r).data("currency"),product_id:e(r).data("product_id"),keep_format:e(r).data("keep_format")})}),i=[...new Set(i.map(JSON.stringify))].map(JSON.parse),e.ajax({url:wooMultiCurrencyParams.ajaxUrl,type:"POST",data:{action:"wmc_get_products_price",pids:c,shortcodes:o,wmc_current_url:e(".wmc-current-url").val(),exchange:i},success(c){if(c.success){let r=c.data.prices||"",t=c.data.current_currency||"",i=c.data.exchange||"";if(o.length>0&&o.length===c.data.shortcodes.length)for(let e=0;e<o.length;e++)a.eq(e).replaceWith(c.data.shortcodes[e]);if("1"!==wooMultiCurrencyParams.switchByJS&&e(".wmc-currency a").unbind(),t&&(e(".wmc-sidebar .wmc-currency").removeClass("wmc-active"),e(`.wmc-sidebar .wmc-currency[data-currency=${t}]`).addClass("wmc-active"),e(".wmc-price-switcher .wmc-current-currency i").removeClass().addClass("vi-flag-64 flag-"+c.data.current_country),e(".wmc-price-switcher .wmc-sub-currency-current").removeClass("wmc-sub-currency-current"),e(`.wmc-price-switcher .wmc-currency[data-currency=${t}]`).addClass("wmc-sub-currency-current"),e(`select.wmc-nav option[data-currency=${t}]`).prop("selected",!0)),r){for(let c in r)e(`.wmc-cache-pid[data-wmc_product_id=${c}]`).replaceWith(r[c]);e(".variations_form").each((c,t)=>{let a=e(t).data("product_variations");a&&(a.map(e=>{let c=e.variation_id;return e.price_html=r[c],e}),e(t).data("product_variations",a))})}if(i)for(let c in i)e(`.wmc-cache-value[data-price="${i[c].price}"][data-product_id="${i[c].product_id}"][data-keep_format="${i[c].keep_format}"][data-original_price="${i[c].original_price}"][data-currency="${i[c].currency}"]`).replaceWith(i[c].shortcode);jQuery(document.body).trigger("wmc_cache_compatible_finish",[c.data])}}})},ajaxComplete(){e(document).on("append.infiniteScroll",()=>{this.cacheCompatible()})}},woocommerce_multi_currency.init()});